(function(t){function e(e){for(var n,o,s=e[0],l=e[1],u=e[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);c&&c(e);while(f.length)f.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],n=!0,s=1;s<r.length;s++){var l=r[s];0!==a[l]&&(n=!1)}n&&(i.splice(e--,1),t=o(o.s=r[0]))}return t}var n={},a={app:0},i=[];function o(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=n,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var c=l;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"1fac":function(t,e,r){},"204d":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.imgArr.length?r("ul",t._l(t.imgArr,(function(e,n){return r("li",{key:n},[r("div",{staticClass:"wrap",on:{click:function(r){return t.viewPic(e)}}},[r("img",{attrs:{src:e,alt:""}})]),r("p",{staticClass:"txt"},[t._v(t._s(e.split("/")[e.split("/").length-1]))])])})),0):r("div",{staticClass:"empty"},[t._v("相册暂无图片")]),r("el-dialog",{staticClass:"pop",attrs:{title:"大图",width:"40%",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("img",{attrs:{src:t.imgCur,alt:""}})])],1)},a=[],i=(r("31d6"),r("a5bc"),r("2ade")),o={data:function(){return{dialogVisible:!1,name:"",imgCur:"",imgArr:[]}},created:function(){this.id=location.href.split("?id=")[1]||"",this.getList()},methods:{getList:function(){var t=this;Object(i["c"])({id:this.id}).then((function(e){200==e.status&&(t.imgArr=e.data)}))},viewPic:function(t){this.imgCur=t,this.dialogVisible=!0}}},s=o,l=(r("626f"),r("5d22")),u=Object(l["a"])(s,n,a,!1,null,"30e9c5a8",null);e["default"]=u.exports},"2ade":function(t,e,r){"use strict";r.d(e,"e",(function(){return d})),r.d(e,"d",(function(){return f})),r.d(e,"f",(function(){return m})),r.d(e,"g",(function(){return p})),r.d(e,"b",(function(){return h})),r.d(e,"c",(function(){return g})),r.d(e,"a",(function(){return v}));r("2a39"),r("0482"),r("a5bc");var n=r("73ef"),a=r.n(n),i=r("2763");a.a.defaults.withcredentials=!0,a.a.defaults.baseURL="";var o,s=0,l=[];function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(r,n){a.a.get(t,{params:e}).then((function(t){r(t)})).catch((function(t){n(t)}))}))}function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(r,n){a.a.post(t,e).then((function(t){r(t)})).catch((function(t){n(t)}))}))}a.a.interceptors.request.use((function(t){return s++,o=i["Loading"].service({target:"loading-area",text:"正在加载中..."}),l.push(o),t}),(function(t){s--,s||l.forEach((function(t){return t.close()})),console.log(t),Promise.reject(t)})),a.a.interceptors.response.use((function(t){if(s--,s||l.forEach((function(t){return t.close()})),t.status&&200==t.status){if(200==t.data.status)return t.data;if(201===t.data.status)i["Message"].error({message:t.data.msg});else{if(202!==t.data.status)return t.data.data?t.data:Promise.reject(t.data);i["Message"].error({message:t.data.msg}),location.href="/admin"}}}),(function(t){return s--,s||l.forEach((function(t){return t.close()})),i["Message"].error({message:t.data.msg}),Promise.reject(t.data)}));var d=function(t){return c("/index.php?controller=admin&method=login",t)},f=function(){return c("/index.php?controller=admin&method=isLogin")},m=function(){return c("/index.php?controller=admin&method=logout")},p=function(){return u("/index.php?controller=folder&method=getList")},h=function(){return u("/index.php?controller=folder&method=getAllFile")},g=function(t){return u("/index.php?controller=folder&method=getAllImg",t)},v=function(t){return u("/index.php?controller=folder&method=foldRecordInDb",t)}},"3ae9":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"home"},[r("div",{staticClass:"nav"},[r("p",{staticClass:"user"},[t._v("Hello, "+t._s(t.name)+".")]),r("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1","background-color":"#333","text-color":"#fff","active-text-color":"#ffd04b"}},[r("el-menu-item",{attrs:{index:"1"}},[r("span",{attrs:{slot:"title"},slot:"title"},[r("router-link",{attrs:{to:{path:"/home/upload"}}},[r("i",{staticClass:"el-icon-menu"}),t._v("图片上传")])],1)]),r("el-menu-item",{attrs:{index:"2"}},[r("span",{attrs:{slot:"title"},slot:"title"},[r("router-link",{attrs:{to:{path:"/home/imgList"}}},[r("i",{staticClass:"el-icon-document"}),t._v("相册列表")])],1)])],1),r("p",{staticClass:"logout",on:{click:t.logoutFn}},[t._v("退出登录")])],1),r("div",{staticClass:"content"},[r("div",{staticClass:"wrap"},[r("router-view")],1)])])},a=[],i=(r("82a8"),r("2ade")),o={name:"home",data:function(){return{name:""}},created:function(){this.loginStatus()},methods:{loginStatus:function(){var t=this;Object(i["d"])().then((function(e){200==e.status?t.name=e.data.name:t.$router.push("/admin")}))},logoutFn:function(){var t=this;Object(i["f"])().then((function(e){200==e.status&&t.$router.push("/admin")}))}}},s=o,l=(r("927b"),r("5d22")),u=Object(l["a"])(s,n,a,!1,null,"0aa87cea",null);e["default"]=u.exports},"56d7":function(t,e,r){"use strict";r.r(e);r("4929"),r("f37a"),r("a0b8"),r("24d2");var n=r("a593"),a=r("73ef"),i=r.n(a),o=r("5e24"),s=r.n(o),l=r("2763"),u=r.n(l),c=(r("ccc1"),r("8aaf"));n["default"].use(c["a"]);var d=new c["a"]({mode:"history",routes:[{path:"/admin",name:"login",components:r("fb12")},{path:"/home",name:"home",components:r("3ae9"),children:[{path:"upload",name:"upload",components:r("9dac")},{path:"imgList",name:"imgList",components:r("ef0b")},{path:"img",name:"img",components:r("204d")}]}]}),f=d,m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},p=[],h=r("5d22"),g={},v=Object(h["a"])(g,m,p,!1,null,null,null),b=v.exports,_=(r("16f7"),r("d1ee")),y=r.n(_);n["default"].use(y.a),n["default"].use(s.a,i.a),n["default"].use(u.a),n["default"].config.productionTip=!1,new n["default"]({el:"#app",router:f,render:function(t){return t(b)}})},"626f":function(t,e,r){"use strict";r("e05d")},"760d":function(t,e,r){},"7b32":function(t,e,r){"use strict";r("760d")},"8d20":function(t,e,r){},9134:function(t,e,r){},"927b":function(t,e,r){"use strict";r("1fac")},"98cc":function(t,e,r){"use strict";r("9134")},"9dac":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"upload"},[r("div",{staticClass:"part-left"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"200px"}},[r("el-form-item",{attrs:{label:"相册名称：",prop:"folderId"}},[r("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或创建相册"},model:{value:t.ruleForm.folderId,callback:function(e){t.$set(t.ruleForm,"folderId",e)},expression:"ruleForm.folderId"}},t._l(t.staticData,(function(t){return r("el-option",{key:t.id,attrs:{label:t.name_ch,value:t.id}})})),1)],1),r("el-form-item",{staticStyle:{"margin-top":"50px"},attrs:{label:"",prop:""}},[r("div",{attrs:{draggable:"true"},on:{click:function(e){return t.handleClickUpload("ruleForm")},dragenter:function(e){return e.preventDefault(),t.handleClickUpload("ruleForm")}}},[r("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"/index.php?controller=folder&method=tempDir",accept:"image/jpeg,image/jpg,image/gif,image/png,.zip,.rar,.tar,.gz",multiple:"",data:t.ruleForm,disabled:!(""!=t.ruleForm.folderId),limit:t.limitNum,"on-exceed":t.handleExceed,"before-upload":t.handleBeforeUpload,"on-success":t.handleOnSuccess,"on-change":t.changeFn,"on-progress":t.handleOnProgress}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[r("p",[t._v("将文件拖到此处，或"),r("em",[t._v("点击上传")])]),r("div",{staticStyle:{padding:"0 10px 20px","line-height":"26px"}},[t._v("支持扩展名："),r("strong",{staticStyle:{"font-weight":"bold"}},[t._v(".jpg .png .gif .zip .rar .tar .gz ")]),t._v(" 单个文件不超过100M, 一次至多上传20个源文件, 封面图默认第一个图片文件 ")])])]),r("p",{staticStyle:{color:"red"}},[t._v("* 文件名称请勿包含特殊字符或中文,压缩包仅解压一级目录")])],1)])],1)],1),t.errArr.length?r("ul",{staticClass:"part-right"},[r("li",[t._v("错误提示：")]),t._l(t.errArr,(function(e,n){return r("li",{key:n},[t._v(" "+t._s(e.msg)+" ")])}))],2):t._e()])},a=[],i=(r("82a8"),r("96f8"),r("f24f"),r("a5bc"),r("2a39"),r("cfa8"),r("2ade")),o={name:"upload",data:function(){return{staticData:[],limitNum:20,errArr:[],ruleForm:{folderId:""},rules:{folderId:[{required:!0,message:"请选择或创建文件夹",trigger:"blur"}]}}},created:function(){this.initData()},methods:{changeFn:function(t,e){var r=this;if(t.response){if(201==t.response.status){var n={name:t.name,msg:t.response.msg};this.errArr.unshift(n),console.log(this.errArr)}if(200==t.response.status){var a=!0;this.staticData.forEach((function(t){t.name_ch!=r.ruleForm.folderId&&t.id!=r.ruleForm.folderId||(a=!1)})),a&&Object(i["a"])({id:this.ruleForm.folderId})}}},handleOnSuccess:function(t,e,r){},handleOnProgress:function(t,e,r){},handleClickUpload:function(t){this.$refs[t].validate((function(t){}))},handleBeforeUpload:function(t){var e=t.size/1024/1024<100,r=/[\u4E00-\u9fff]+/g,n=r.test(t.name);function a(e){var r=t.name,n=0;return null!=e&&e.forEach((function(t){t.name==r&&(n+=1)})),n}return t.name.toString().match(/[\',:;*?~`!#$%^&+=)(<>{}]|\]|\[|\/|\\\|"|\|/gi)?(this.$message({message:"".concat(t.name," 包含特殊字符,请重新修改文件名"),type:"error"}),!1):n?(this.$message({message:"".concat(t.name," 包含中文"),type:"error"}),!1):e?a(this.imgFileCache)>1?(this.$message({message:"".concat(t.name," 文件名已存在, 请重新修改文件名！"),type:"error"}),!1):void 0:(this.$message({message:"".concat(t.name," 文件超过 100M, 上传失败!"),type:"error"}),!1)},handleExceed:function(t,e){this.$message({message:"当前上传数量限制为"+this.limitNum,type:"error"})},initData:function(){var t=this;Object(i["g"])().then((function(e){t.staticData=e.data}))}}},s=o,l=(r("98cc"),r("5d22")),u=Object(l["a"])(s,n,a,!1,null,"3c7e74b8",null);e["default"]=u.exports},c42c:function(t,e,r){"use strict";r("8d20")},e05d:function(t,e,r){},ef0b:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ul",t._l(t.imgList,(function(e,n){return r("li",{key:n,on:{click:function(r){return t.linkToIMg(e.id)}}},[r("img",{attrs:{src:e.link,alt:""}}),r("p",[t._v(t._s(e.name))])])})),0)])},a=[],i=r("2ade"),o={name:"imgList",data:function(){return{imgList:[],staticData:[]}},created:function(){this.init()},methods:{init:function(){var t=this;Object(i["b"])().then((function(e){console.log(e.data),t.imgList=e.data})),Object(i["g"])().then((function(e){t.staticData=e.data}))},linkToIMg:function(t){this.$router.push({path:"/home/img",query:{id:t}})}}},s=o,l=(r("7b32"),r("5d22")),u=Object(l["a"])(s,n,a,!1,null,"7c6840a4",null);e["default"]=u.exports},fb12:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrap"},[r("div",{staticClass:"login-wrap"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"0"}},[r("el-form-item",{attrs:{label:"",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),r("el-form-item",{attrs:{label:"",prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitForm("ruleForm")}},model:{value:t.ruleForm.password,callback:function(e){t.$set(t.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),r("el-form-item",[r("el-button",{staticClass:"btn",staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm")}}},[t._v("登录")])],1)],1)],1)])},a=[],i=r("2ade"),o={name:"login",data:function(){return{ruleForm:{name:"",password:""},rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;Object(i["e"])(e.ruleForm).then((function(t){200==t.status&&e.$router.push("/home/upload")}))}))}}},s=o,l=(r("c42c"),r("5d22")),u=Object(l["a"])(s,n,a,!1,null,"4ffb8654",null);e["default"]=u.exports}});
//# sourceMappingURL=app.5531c549.js.map