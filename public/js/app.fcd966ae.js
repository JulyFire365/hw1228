(function(e){function t(t){for(var r,s,o=t[0],l=t[1],c=t[2],d=0,f=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&f.push(i[s][0]),i[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"00ab":function(e,t,n){"use strict";n("6c14")},"204d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.imgArr.length?n("ul",e._l(e.imgArr,(function(t,r){return n("li",{key:r},[n("div",{staticClass:"wrap",on:{click:function(n){return e.viewPic(t)}}},[n("img",{attrs:{src:t.thumbImg,alt:""}})]),n("p",{staticClass:"txt"},[e._v(e._s(t.originImg.split("/")[t.originImg.split("/").length-1]))])])})),0):n("div",{staticClass:"empty"},[e._v("相册暂无图片")]),n("el-dialog",{staticClass:"pop",attrs:{title:"",height:"80%",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("img",{attrs:{src:e.imgCur,alt:""}})])],1)},i=[],a=(n("ac1f"),n("1276"),n("2ade")),s={data:function(){return{dialogVisible:!1,name:"",imgCur:"",imgArr:[]}},created:function(){this.id=location.href.split("?id=")[1]||"",this.getAllFn()},methods:{getAllFn:function(){var e=this;Object(a["c"])({id:this.id}).then((function(t){200==t.status&&(e.imgArr=t.data)}))},viewPic:function(e){this.imgCur=e.originImg,this.dialogVisible=!0}}},o=s,l=(n("3242"),n("2877")),c=Object(l["a"])(o,r,i,!1,null,"44815226",null);t["default"]=c.exports},"2ade":function(e,t,n){"use strict";n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return b}));n("d3b7"),n("ac1f"),n("5319");var r=n("bc3a"),i=n.n(r),a=n("5c96");i.a.defaults.withcredentials=!0,i.a.defaults.baseURL="";var s,o=0,l=[];function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){i.a.get(e,{params:t}).then((function(e){n(e)})).catch((function(e){r(e)}))}))}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){i.a.post(e,t).then((function(e){n(e)})).catch((function(e){r(e)}))}))}i.a.interceptors.request.use((function(e){return o++,s=a["Loading"].service({target:"loading-area",text:"正在加载中..."}),l.push(s),e}),(function(e){o--,o||l.forEach((function(e){return e.close()})),console.log(e),Promise.reject(e)})),i.a.interceptors.response.use((function(e){if(o--,o||l.forEach((function(e){return e.close()})),e.status&&200==e.status){if(200==e.data.status)return e.data;if(201===e.data.status)a["Message"].error({message:e.data.msg});else{if(202!==e.data.status)return e.data.data?e.data:Promise.reject(e.data);a["Message"].error({message:e.data.msg}),location.href="/admin"}}}),(function(e){return o--,o||l.forEach((function(e){return e.close()})),a["Message"].error({message:e.data.msg}),Promise.reject(e.data)}));var d=function(e){return u("/index.php?controller=admin&method=login",e)},f=function(){return u("/index.php?controller=admin&method=isLogin")},m=function(){return u("/index.php?controller=admin&method=logout")},p=function(){return c("/index.php?controller=folder&method=getList")},h=function(e){return c("/index.php?controller=folder&method=getAllImg",e)},g=function(e){return c("/index.php?controller=folder&method=foldRecordInDb",e)},v=function(e){return c("/index.php?controller=folder&method=delFold",e)},b=function(){return c("/index.php?controller=permission&method=getPermission")}},3242:function(e,t,n){"use strict";n("325d")},"325d":function(e,t,n){},"3ae9":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("div",{staticClass:"nav"},[n("p",{staticClass:"user"},[e._v("Hello, "+e._s(e.name)+".")]),n("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1","background-color":"#333","text-color":"#fff","active-text-color":"#ffd04b"}},[n("el-menu-item",{attrs:{index:"1"}},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a",{attrs:{href:"/home/upload"}},[n("i",{staticClass:"el-icon-menu"}),e._v("图片上传")])])]),n("el-menu-item",{attrs:{index:"2"}},[n("span",{attrs:{slot:"title"},slot:"title"},[n("a",{attrs:{href:"/home/imgList"}},[n("i",{staticClass:"el-icon-document"}),e._v("相册列表")])])])],1),n("p",{staticClass:"logout",on:{click:e.logoutFn}},[e._v("退出登录")])],1),n("div",{staticClass:"content"},[n("div",{staticClass:"wrap"},[n("router-view")],1)])])},i=[],a=(n("b0c0"),n("2ade")),s={name:"home",data:function(){return{name:""}},created:function(){this.loginStatus()},methods:{loginStatus:function(){var e=this;Object(a["e"])().then((function(t){200==t.status?e.name=t.data.name:e.$router.push("/admin")}))},logoutFn:function(){var e=this;Object(a["g"])().then((function(t){200==t.status&&e.$router.push("/admin")}))}}},o=s,l=(n("00ab"),n("2877")),c=Object(l["a"])(o,r,i,!1,null,"1880751e",null);t["default"]=c.exports},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=n("bc3a"),a=n.n(i),s=n("2106"),o=n.n(s),l=n("5c96"),c=n.n(l),u=(n("0fae"),n("8c4f"));r["default"].use(u["a"]);var d=new u["a"]({mode:"history",routes:[{path:"/admin",name:"login",components:n("fb12")},{path:"/home",name:"home",components:n("3ae9"),children:[{path:"upload",name:"upload",components:n("9dac")},{path:"imgList",name:"imgList",components:n("ef0b")},{path:"img",name:"img",components:n("204d")}]}]}),f=d,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},p=[],h=n("2877"),g={},v=Object(h["a"])(g,m,p,!1,null,null,null),b=v.exports,_=(n("fa6d"),n("1f94")),y=n.n(_);r["default"].use(y.a),r["default"].use(o.a,a.a),r["default"].use(c.a),r["default"].config.productionTip=!1,new r["default"]({el:"#app",router:f,render:function(e){return e(b)}})},"5cf2":function(e,t,n){"use strict";n("ff7d")},"6c14":function(e,t,n){},"9dac":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload"},[n("div",{staticClass:"part-left"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"0px"}},[n("el-form-item",{attrs:{label:"",prop:"folderId"}},[n("el-select",{ref:"selectWrap",attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或创建相册"},on:{change:e.changeDir,"hook:mounted":e.cancalReadOnly,"visible-change":e.cancalReadOnly},model:{value:e.ruleForm.folderId,callback:function(t){e.$set(e.ruleForm,"folderId",t)},expression:"ruleForm.folderId"}},e._l(e.staticData,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name_ch,value:e.id}})})),1)],1),n("el-form-item",{staticStyle:{"margin-top":"50px"},attrs:{label:"",prop:""}},[n("div",{attrs:{draggable:"true"},on:{click:function(t){return e.handleClickUpload("ruleForm")},dragenter:function(t){return t.preventDefault(),e.handleClickUpload("ruleForm")}}},[n("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"/index.php?controller=folder&method=tempDir",accept:"image/jpeg,image/jpg,image/gif,image/png,.zip,.rar,.tar,.gz",multiple:"",data:e.ruleForm,disabled:!(""!=e.ruleForm.folderId),limit:e.limitNum,"on-exceed":e.handleExceed,"before-upload":e.handleBeforeUpload,"on-success":e.handleOnSuccess,"on-change":e.changeFn,"on-progress":e.handleOnProgress}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[n("p",[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])]),n("div",{staticStyle:{padding:"0 10px 20px","line-height":"26px"}},[e._v("支持扩展名："),n("strong",{staticStyle:{"font-weight":"bold"}},[e._v(".jpg .png .gif .zip .rar .tar .gz ")]),e._v(" 单个文件不超过200M, 一次至多上传200个源文件, 封面图默认第一个图片文件 ")])])]),n("p",{staticStyle:{color:"red"}},[e._v("* 文件名称请勿包含特殊字符或中文,压缩包仅解压一级目录")])],1)])],1)],1),e.errArr.length?n("ul",{staticClass:"part-right"},[n("li",[e._v("错误提示：")]),e._l(e.errArr,(function(t,r){return n("li",{key:r},[e._v(" "+e._s(t.msg)+" ")])}))],2):e._e()])},i=[],a=(n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("466d"),n("159b"),n("2ade")),s={name:"upload",data:function(){return{insetDirFlag:!0,width:document.body.clientWidth,staticData:[],limitNum:200,errArr:[],ruleForm:{folderId:""},rules:{folderId:[{required:!0,message:"请选择或创建文件夹",trigger:"blur"}]}}},created:function(){this.initData()},methods:{cancalReadOnly:function(e){var t=this;this.$nextTick((function(){if(!e){var n=t.$refs,r=n.selectWrap.$el.querySelector(".el-input__inner");r.removeAttribute("readonly")}}))},changeDir:function(){this.insetDirFlag=!0},changeFn:function(e,t){var n=this;if(e.response){if(201==e.response.status){var r={name:e.name,msg:e.response.msg};this.errArr.unshift(r),console.log(this.errArr)}if(200==e.response.status){var i=!0;this.staticData.forEach((function(e){e.name_ch!=n.ruleForm.folderId&&e.id!=n.ruleForm.folderId||(i=!1)})),this.insetDirFlag&&i&&Object(a["b"])({id:this.ruleForm.folderId}),this.insetDirFlag=!1}}},handleOnSuccess:function(e,t,n){},handleOnProgress:function(e,t,n){},handleClickUpload:function(e){this.$refs[e].validate((function(e){}))},handleBeforeUpload:function(e){var t=e.size/1024/1024<201,n=/[\u4E00-\u9fff]+/g,r=n.test(e.name);function i(t){var n=e.name,r=0;return null!=t&&t.forEach((function(e){e.name==n&&(r+=1)})),r}return e.name.toString().match(/[\',:;*?~`!#$%^&+=)(<>{}]|\]|\[|\/|\\\|"|\|/gi)?(this.$message({message:"".concat(e.name," 包含特殊字符,请重新修改文件名"),type:"error"}),!1):r?(this.$message({message:"".concat(e.name," 包含中文"),type:"error"}),!1):t?i(this.imgFileCache)>1?(this.$message({message:"".concat(e.name," 文件名已存在, 请重新修改文件名！"),type:"error"}),!1):void 0:(this.$message({message:"".concat(e.name," 文件超过 200M, 上传失败!"),type:"error"}),!1)},handleExceed:function(e,t){this.$message({message:"当前上传数量限制为"+this.limitNum,type:"error"})},initData:function(){var e=this;Object(a["h"])().then((function(t){e.staticData=t.data}))}}},o=s,l=(n("5cf2"),n("2877")),c=Object(l["a"])(o,r,i,!1,null,"251e8f90",null);t["default"]=c.exports},c72d:function(e,t,n){},d9c8:function(e,t,n){},df2e:function(e,t,n){"use strict";n("c72d")},ef0b:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.permission.includes("del")?n("el-button",{staticClass:"del-wrap",attrs:{type:"primary"},on:{click:e.delFn}},[e._v("删除选中相册")]):e._e(),n("el-checkbox-group",{model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},[n("ul",e._l(e.staticData,(function(t,r){return n("li",{key:r},[n("div",{staticClass:"img-wrap"},[n("img",{attrs:{src:t.link,alt:""},on:{click:function(n){return e.linkToIMg(t.id)}}})]),n("div",{staticClass:"fold-name"},["默认相册"!=t.name_ch&&"wh"!=t.name_ch&&e.permission.includes("del")?n("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name_ch))]):n("div",{staticStyle:{"font-size":"13px","padding-top":"2px"}},[e._v(e._s(t.name_ch))])],1)])})),0)])],1)},i=[],a=(n("caad"),n("a434"),n("2532"),n("2ade")),s={name:"imgList",data:function(){return{checkedCities:[],idArr:[],staticData:[],permission:[]}},created:function(){this.init(),this.getPermission()},methods:{delFn:function(){var e=this;if(!this.checkedCities.length)return this.$message.error("未选中任何相册"),!1;for(var t=0;t<this.staticData.length;t++)this.checkedCities.includes(this.staticData[t]["id"])&&this.staticData.splice(t,1);Object(a["a"])({idArr:this.checkedCities}).then((function(t){200==t.status&&e.$message.success("删除成功")}))},getPermission:function(){var e=this;Object(a["d"])().then((function(t){e.permission=t.data.permission}))},init:function(){var e=this;Object(a["h"])().then((function(t){e.staticData=t.data}))},linkToIMg:function(e){this.$router.push({path:"/home/img",query:{id:e}})}}},o=s,l=(n("df2e"),n("2877")),c=Object(l["a"])(o,r,i,!1,null,"63c1fd34",null);t["default"]=c.exports},ef8e:function(e,t,n){"use strict";n("d9c8")},fb12:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wraps"},[n("div",{staticClass:"login-wrap"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"0"}},[n("el-form-item",{attrs:{label:"",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:"",prop:"password"}},[n("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("ruleForm")}},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),n("el-form-item",[n("el-button",{staticClass:"btn",staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("登录")])],1)],1)],1)])},i=[],a=n("2ade"),s={name:"login",data:function(){return{ruleForm:{name:"",password:""},rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;Object(a["f"])(t.ruleForm).then((function(e){200==e.status&&t.$router.push("/home/upload")}))}))}}},o=s,l=(n("ef8e"),n("2877")),c=Object(l["a"])(o,r,i,!1,null,"7f05d2d4",null);t["default"]=c.exports},ff7d:function(e,t,n){}});
//# sourceMappingURL=app.fcd966ae.js.map